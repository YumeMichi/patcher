From e145f1f13c99e9ab3f5a4858254a09def533d921 Mon Sep 17 00:00:00 2001
From: maxwen <max.weninger@gmail.com>
Date: Mon, 1 Oct 2018 16:43:08 +0200
Subject: [PATCH] sepolicy: Add syslog_read perms for Matlog

Change-Id: Ie7d88e717fe233b3a241d580af85b01639123261
---
 public/app.te | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/public/app.te b/public/app.te
index 5c48e71f..0145a7ba 100644
--- a/public/app.te
+++ b/public/app.te
@@ -516,7 +516,8 @@ neverallow appdomain
     proc:dir_file_class_set write;
 
 # Access to syslog(2) or /proc/kmsg.
-neverallow appdomain kernel:system { syslog_read syslog_mod syslog_console };
+neverallow { appdomain -system_app -shell -platform_app -priv_app }
+    kernel:system { syslog_read syslog_mod syslog_console };
 
 # SELinux is not an API for apps to use
 neverallow { appdomain -shell } *:security { compute_av check_context };
-- 
2.28.0

